window.MSModule_bubble=new MSModule_bubble;
function MSModule_bubble(){function p(d,a,b){a.textDeferred="";r(d,a,b)}function r(d,a,b){b=t(d,a,b,a.width-12,a.height-10-a.tailheight);0<b.remain.length&&(a.textDeferred=b.remain);var g=a.width-4,k=1==a.tailstyle?parseInt(a.tailheight):0,l=2==a.tailstyle?parseInt(a.tailheight):0,h=1==a.autosize?a.height:b.height+10+parseInt(a.tailheight);2==a.tailstyle&&(h-=13);var e=1==a.tailstyle?3==a.autosize?parseInt(a.height)-h:2:l+8,c=g*parseInt(a.tailattach)/100;15>c&&(c=15);c>g-15&&(c=g-15);var q=parseInt(a.tailskew),
m=parseInt(a.tailwidth),n=document.getElementById(d.idDiv+a.id+"Canvas"),f=n.getContext("2d");f.clearRect(0,0,n.width,n.height);d.android&&d.bug_workaround(n);f.lineWidth=2*parseInt(a.linewidth);f.strokeStyle=a.linecolor;f.fillStyle=a.bubblecolor;f.beginPath();f.moveTo(12,e);"2"==a.tailstyle&&(f.lineTo(2+c-m/2,e),f.lineTo(2+c+q,e-l),f.lineTo(2+c+m/2,e));f.lineTo(2+g-10,e);f.arcTo(2+g,e,2+g,e+10,10);f.lineTo(2+g,e+h-k-10);f.arcTo(2+g,e+h-k,2+g-10,e+h-k,10);"1"==a.tailstyle&&(f.lineTo(2+c+m/2,e+h-k),
f.lineTo(2+c+q,e+h),f.lineTo(2+c-m/2,e+h-k));f.lineTo(12,e+h-k);f.arcTo(2,e+h-k,2,e+h-k-10,10);f.lineTo(2,e+10);f.arcTo(2,e,12,e,10);f.closePath();f.stroke();f.fill();g=document.getElementById(d.idDiv+a.id+"Text");g.style.top=e+5+"px";g.innerHTML=b.text;document.getElementById(d.idDiv+a.id+"Div").style.display="block";a.timer&&clearTimeout(a.timer);b=u(b.text,a);a.timer=setTimeout(function(){a.timer=0;0<a.textDeferred.length?p(d,a,a.textDeferred):document.getElementById(d.idDiv+a.id+"Div").style.display=
"none"},b)}function t(d,a,b,g,k){d=document.getElementById(d.idDiv+"Measure");var l="",h=0,e=0;d.style.fontFamily=a.fontname;for(d.style.fontSize=a.fontheight+"px";0<b.length;){b=b.trim();var c=0;for(a=0;c<b.length;){for(;c<b.length&&" "!=b.substr(c,1)&&"-"!=b.substr(c,1);)c++;"-"==b.substr(c,1)&&c++;for(iTest=c;c<b.length&&" "==b.substr(c,1);)c++;d.innerHTML=b.substr(0,iTest);if(d.clientWidth>g)break;else a=iTest}0==a&&(a=iTest);c=l;0<c.length&&(c+="<br/>");c+=b.substr(0,a);d.innerHTML=c;if(d.clientHeight<
k||0==h)l=c,h++,b=b.substr(a),e=d.clientHeight;else break}a={text:l,height:e,remain:b};d.innerHTML="";return a}function u(d,a){var b=d.split(" ").length;return a.minshow+6E4*b/a.wpm}this.render=function(d,a){var b;b=""+('<div id="'+d.idDiv+a.id+'Div" style="position:absolute; left:'+a.left+"px; top:"+a.top+'px;">');b+='<div id="'+d.idDiv+a.id+'Inner" style="position:relative; left:0px; top:0px;" width="'+(a.width+5)+'" height="'+(a.height+8)+'">';b+='<canvas id="'+d.idDiv+a.id+'Canvas" style="position:absolute; left:0px; top:0px;" width="'+
(a.width+5)+'" height="'+(a.height+8)+'"></canvas>';b+='<div id="'+d.idDiv+a.id+'Text" style="position:absolute; left:5px; top:5px; width:'+(parseInt(a.width)-10)+"px; height:0px;";b+="font-family:"+a.fontname+"; font-size:"+a.fontheight+"px;";b+="font-color:"+a.fontcolor+";";a.fontbold&&(b+=" font-weight:bold;");a.fontitalic&&(b+=" font-style:italic;");b+='"></div>';b+="</div>";return b+="</div>"};this.event=function(d,a,b,g){};this.updateBubble=p}msModuleLoaded();